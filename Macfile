# 
# Macfile, got it?
# 

CC= clang
CPPC= clang++

CFLAGS= `llvm-config --cflags` -Wall
CPPFLAGS= `llvm-config --cxxflags --ldflags --system-libs \
	--libs core bitreader bitwriter irreader`

all:
	$(CC) $(CFLAGS) -fpic -c src/core.c -o llvmcore.o
	$(CPPC) $(CPPFLAGS) llvmcore.o -dynamiclib -o llvmcore.dylib -llua.5.3.4

	lua tests/test_core.lua

clean:
	@- rm -f *.so
	@- rm -f *.o
	@- rm -f *.dylib
